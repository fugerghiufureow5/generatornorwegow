"use strict";function SlotMachine(i,o,e,t){var p=this,h=24,n={reelHeight:1200,reelWidth:200,reelOffset:20,slotYAxis:0,animSpeed:1e3,sounds:{reelsBegin:null,reelsEnd:null},rngFunc:function(){return Math.random()}};function r(){var r=[];e&&(r.push=function(){if(Array.prototype.push.apply(this,arguments),r.length===o.length)var t=window.setTimeout(function(){p.isAnimating=!1,e(r),window.clearTimeout(t)},p.options.animSpeed)}),s(p.options.sounds.reelsBegin),o.forEach(function(t){var e=function(t){for(var e=0,n=t.length,i=0;i<n;i++){e+=t[i].weight}for(var o=l()*e,r=0;r<n;r++){var s=t[r],a=s.weight;if(o<a)return s;o-=a}}(t.symbols),n=e.position,i=t.element;i.classList.remove("stop"),i.classList.toggle("spin"),i.childNodes.forEach(function(t,e){t.style.backgroundPositionY=f(e,n)+"px"});var o=window.setTimeout(function(){i.classList.replace("spin","stop"),s(p.options.sounds.reelsEnd),r.push(e),window.clearTimeout(o)},p.options.animSpeed*function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10,n=Math.ceil(t),i=Math.floor(e);return Math.floor(l()*(Math.floor(i)-n))+n}(1,4))})}function l(){return p.options.rngFunc()}function f(t,e){return-Math.abs(m()*t+(e-p.options.reelOffset))}function m(){return p.options.reelHeight/h}function s(t){if(t){var e=new Audio;e.src=t,e.onerror=function(){return console.warn("Failed to load audio: "+t)},e.play()}}!function(){if(p.options=Object.assign(n,t),!(0<o.length))throw new Error("Failed to initialize (missing reels)");(function(){var t=document.createElement("div");t.classList.add("display");for(var e=0;e<o.length;e++){var n=document.createElement("div");n.style.transform="rotateY("+p.options.slotYAxis+"deg)",n.classList.add("reel"),t.appendChild(n)}t.addEventListener("click",function(){return r()}),i.appendChild(t)})(),function(){var n=document.createElement("div");n.classList.add("slots"),o.forEach(function(t){var e=function(t){var e=document.createElement("div");e.style.transform="rotateY("+p.options.slotYAxis+"deg)",e.classList.add("reel");var n=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=m(),i=p.options.reelWidth,o=360/h,r=Math.trunc(Math.tan(90/Math.PI-o)*(.5*n)*4),s=r+n/2,a=document.createElement("ul");a.style.height=n+"px",a.style.marginTop=s+"px",a.style.width=i+"px",a.classList.add("strip");for(var l=0;l<h;l++){var d=document.createElement("li");d.append(l.toString());var c=f(l,e),u=h*o-l*o;d.style.background="url("+t.imageSrc+") 0 "+c+"px",d.style.height=n+"px",d.style.width=i+"px",d.style.transform="rotateX("+u+"deg) translateZ("+r+"px)",a.appendChild(d)}return a}(t,t.symbols[0].position);return t.element=n,e.appendChild(n),e}(t,t.symbols[0].position);n.appendChild(e)}),i.appendChild(n)}()}(),this.play=function(){!function(t){p.isAnimating||(p.isAnimating=!0,t.call(p))}(r)}}window.slotMachine=function(t,e,n,i){return new SlotMachine(t,e,n,i)},"undefined"!=typeof module&&module.exports&&(module.exports=SlotMachine);